language: node_js
os: linux
node_js:
   - "10"

before_script:
   - npm install
   - npm install --save-dev mocha chai

jobs:
   include:
      - stage: "test"
        name: "Run unit test"
        script: npm test

      - stage: "build"
        name: "Push to docker hub"
        script: exit 1
        if: branch = master

      - stage: "deploy"
        name: "Deploy app to kube"
        script: echo meowmeow
        if: branch = master

notifications:
   email:
      recipients:
      - luannm@dwarvesv.com
      on_success: always
      on_failure: always
